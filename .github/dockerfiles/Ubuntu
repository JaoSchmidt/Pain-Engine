# Base image
FROM ubuntu:22.04

# Set non-interactive frontend
ENV DEBIAN_FRONTEND=noninteractive



# Install dependencies that can be found by default on ubuntu
RUN apt-get update && apt-get install -y \
		ca-certificates \
		wget \
		gpg \
    g++ \
    rsync \
    ccache \
    git \
    make \
		pkg-config \
		zlib1g \
		bzip2 \
		gzip \
    && apt-get clean

# Install latest cmake
RUN test -f /usr/share/doc/kitware-archive-keyring/copyright || wget -O - https://apt.kitware.com/keys/kitware-archive-latest.asc 2>/dev/null | gpg --dearmor - | sudo tee /usr/share/keyrings/kitware-archive-keyring.gpg >/dev/null
RUN echo 'deb [signed-by=/usr/share/keyrings/kitware-archive-keyring.gpg] https://apt.kitware.com/ubuntu/ jammy main' | sudo tee /etc/apt/sources.list.d/kitware.list >/dev/null
RUN sudo apt-get update && apt-get install cmake

# These dependencies are not installed by default on ubuntu
RUN apt-get install -y \
		libpng-dev \
		libbz2-dev \
		libharfbuzz-dev \
		libbrotli-dev

# Stuff for the sound and the framework (OpenGL, Vulkan, directx, metal, etc.)
RUN apt-get install -y \
		mesa-utils \
		libglu1-mesa-dev \
		mesa-common-dev \
		libasound2-dev \
		libxext-dev

# https://askubuntu.com/questions/692223/apt-method-bzip2-doesnt-exist
RUN ln -s /usr/lib/apt/methods/gzip /usr/lib/apt/methods/bzip2

# To quick see current versions, uncomment this
# RUN g++ --version && rsync --version && ccache --version && git --version && make --version && cmake --version

# Default command
CMD ["/bin/bash"]
